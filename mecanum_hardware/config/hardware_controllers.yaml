controller_manager:
  ros__parameters:
    update_rate: 50  # 50Hz for hardware (lower than simulation for reliability)
    use_sim_time: false
    
    # Joint State Broadcaster - publishes joint states to /joint_states
    joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster
    
    # Mecanum Drive Controller - handles mecanum kinematics
    mecanum_drive_controller:
      type: mecanum_drive_controller/MecanumDriveController

# Joint State Broadcaster Configuration
joint_state_broadcaster:
  ros__parameters:
    joints:
      - front_left_joint
      - front_right_joint
      - back_left_joint
      - back_right_joint
    interfaces:
      - position
      - velocity

# Mecanum Drive Controller Configuration
mecanum_drive_controller:
  ros__parameters:
    # Wheel configuration (must match your hardware URDF)
    front_left_wheel_name: front_left_joint
    front_right_wheel_name: front_right_joint
    back_left_wheel_name: back_left_joint
    back_right_wheel_name: back_right_joint
    
    # Robot geometry (meters)
    # These should match your actual robot dimensions
    wheel_separation_x: 0.25  # Distance between front and back wheels
    wheel_separation_y: 0.30  # Distance between left and right wheels
    wheel_radius: 0.05        # Wheel radius (5cm)
    
    # Velocity and acceleration limits
    # Conservative limits for NEMA23 steppers without encoders
    linear:
      x:
        max_velocity: 0.5      # m/s (conservative for steppers)
        min_velocity: -0.5
        max_acceleration: 0.3   # m/s² (smooth acceleration)
        min_acceleration: -0.3
      y:
        max_velocity: 0.5
        min_velocity: -0.5
        max_acceleration: 0.3
        min_acceleration: -0.3
    
    angular:
      z:
        max_velocity: 1.0       # rad/s (conservative rotation)
        min_velocity: -1.0
        max_acceleration: 0.5   # rad/s²
        min_acceleration: -0.5
    
    # Odometry configuration
    # Note: For hardware, cartographer will fuse this with IMU for better accuracy
    odom_frame_id: odom
    base_frame_id: base_link
    pose_covariance_diagonal: [0.01, 0.01, 0.01, 0.01, 0.01, 0.03]  # x, y, z, roll, pitch, yaw
    twist_covariance_diagonal: [0.01, 0.01, 0.01, 0.01, 0.01, 0.03]
    
    # Publishing
    enable_odom_tf: true        # Publish odom->base_link TF
    publish_rate: 50.0          # Hz
    open_loop: false            # Use closed-loop control (feedback from steppers)
    
    # Command timeout
    cmd_vel_timeout: 0.5        # Stop if no command for 0.5 seconds (safety)
    
    # Wheel command interface type
    command_interface_type: velocity  # Steppers accept velocity commands
